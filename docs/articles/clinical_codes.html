<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clinical codes - lookups and mappings • ukbwranglr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clinical codes - lookups and mappings">
<meta property="og:description" content="ukbwranglr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ukbwranglr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clinical_codes.html">Clinical codes - lookups and mappings</a>
    </li>
    <li>
      <a href="../articles/ukb_clinical_events.html">Clinical events</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="clinical_codes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clinical codes - lookups and mappings</h1>
            
      
      
      <div class="hidden name"><code>clinical_codes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ukbwranglr</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette describes how to work with clinical codes using <code>ukbwranglr</code>. Specifically:</p>
<ul>
<li>Looking up codes and their descriptions</li>
<li>Getting ‘children’ codes</li>
<li>Mapping codes from one coding system to another</li>
</ul>
<p>The functions provided by <code>ukbwranglr</code> rely on <a href="https://biobank.ndph.ox.ac.uk/ukb/refer.cgi?id=592">UK Biobank resource 592</a>, which includes an Excel workbook containing lookup and mapping tables. This has been converted into a named list of data frames, where each item in the list corresponds to a sheet in the original Excel workbook. This can be retrieved with <code><a href="../reference/get_ukb_code_mappings.html">get_ukb_code_mappings()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve code mappings in .Rdata format</span>
<span class="va">ukb_code_mappings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ukb_code_mappings.html">get_ukb_code_mappings</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># each item in the list is a sheet in the UKB Excel workbook (resource 592)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ukb_code_mappings</span><span class="op">)</span>
<span class="co">#&gt;  [1] "bnf_lkp"           "dmd_lkp"           "icd9_lkp"         </span>
<span class="co">#&gt;  [4] "icd10_lkp"         "icd9_icd10"        "read_v2_lkp"      </span>
<span class="co">#&gt;  [7] "read_v2_drugs_lkp" "read_v2_drugs_bnf" "read_v2_icd9"     </span>
<span class="co">#&gt; [10] "read_v2_icd10"     "read_v2_opcs4"     "read_v2_read_ctv3"</span>
<span class="co">#&gt; [13] "read_ctv3_lkp"     "read_ctv3_icd9"    "read_ctv3_icd10"  </span>
<span class="co">#&gt; [16] "read_ctv3_opcs4"   "read_ctv3_read_v2"</span></code></pre></div>
</div>
<div id="code-lookups" class="section level1">
<h1 class="hasAnchor">
<a href="#code-lookups" class="anchor"></a>Code lookups</h1>
<p>To lookup details for a particular code, use <code><a href="../reference/lookup_codes.html">lookup_codes()</a></code>. Setting <code>preferred_description_only</code> to <code>TRUE</code> will return only the preferred code descriptions if synonyms are present (<code>read2</code> and <code>read3</code> may include multiple descriptions for the same code):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Some Read2 codes for T1DM</span>
<span class="va">t1dm_read2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C10E."</span>, <span class="st">"C108."</span><span class="op">)</span>

<span class="co"># lookup details</span>
<span class="fu"><a href="../reference/lookup_codes.html">lookup_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>,
             code_type <span class="op">=</span> <span class="st">"read2"</span>,
             ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>,
             preferred_description_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   read_code term_code term_description                   </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                              </span>
<span class="co">#&gt; 1 C108.     00        Insulin dependent diabetes mellitus</span>
<span class="co">#&gt; 2 C10E.     00        Type 1 diabetes mellitus</span></code></pre></div>
</div>
<div id="children-codes" class="section level1">
<h1 class="hasAnchor">
<a href="#children-codes" class="anchor"></a>Children codes</h1>
<p>To get the children codes, use <code><a href="../reference/get_child_codes.html">get_child_codes()</a></code>. This will return all unique clinical codes that start with the codes of interest:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Some Read2 codes for T1DM</span>
<span class="va">t1dm_read2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C10E."</span>, <span class="st">"C108."</span><span class="op">)</span>

<span class="co"># lookup details</span>
<span class="fu"><a href="../reference/get_child_codes.html">get_child_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>, 
                code_type <span class="op">=</span> <span class="st">"read2"</span>, 
                ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
                codes_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;  [1] "C108." "C1080" "C1081" "C1082" "C1083" "C1084" "C1085" "C1086" "C1087"</span>
<span class="co">#&gt; [10] "C1088" "C1089" "C108A" "C108B" "C108C" "C108D" "C108E" "C108F" "C108G"</span>
<span class="co">#&gt; [19] "C108H" "C108J" "C108y" "C108z" "C10E." "C10E0" "C10E1" "C10E2" "C10E3"</span>
<span class="co">#&gt; [28] "C10E4" "C10E5" "C10E6" "C10E7" "C10E8" "C10E9" "C10EA" "C10EB" "C10EC"</span>
<span class="co">#&gt; [37] "C10ED" "C10EE" "C10EF" "C10EG" "C10EH" "C10EJ" "C10EK" "C10EL" "C10EM"</span>
<span class="co">#&gt; [46] "C10EN" "C10EP" "C10EQ" "C10ER"</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Some coding systems include a ‘.’ (e.g. ICD-10) - this may return unexpected results with <code><a href="../reference/get_child_codes.html">get_child_codes()</a></code>, as this function searches using regexs and ‘.’ is interpreted as a wildcard.</p>
</blockquote>
<p>By default, a character vector of codes is returned. To return a data frame including code descriptions, set the argument <code>codes_only</code> to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Some Read2 codes for T1DM</span>
<span class="va">t1dm_read2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C10E."</span>, <span class="st">"C108."</span><span class="op">)</span>

<span class="co"># lookup details</span>
<span class="fu"><a href="../reference/get_child_codes.html">get_child_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>, 
                code_type <span class="op">=</span> <span class="st">"read2"</span>, 
                ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
                codes_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   read_code term_code term_description                                          </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                                                     </span>
<span class="co">#&gt; 1 C108.     00        Insulin dependent diabetes mellitus                       </span>
<span class="co">#&gt; 2 C1080     00        Insulin-dependent diabetes mellitus with renal complicati…</span>
<span class="co">#&gt; 3 C1081     00        Insulin-dependent diabetes mellitus with ophthalmic compl…</span>
<span class="co">#&gt; 4 C1082     00        Insulin-dependent diabetes mellitus with neurological com…</span>
<span class="co">#&gt; 5 C1083     00        Insulin dependent diabetes mellitus with multiple complic…</span>
<span class="co">#&gt; 6 C1084     00        Unstable insulin dependent diabetes mellitus</span></code></pre></div>
</div>
<div id="find-codes-that-match-a-description" class="section level1">
<h1 class="hasAnchor">
<a href="#find-codes-that-match-a-description" class="anchor"></a>Find codes that match a description</h1>
<p>Use <code><a href="../reference/search_codes_by_description.html">search_codes_by_description()</a></code>. For example, to find Read2 codes that match the description ‘diabetic retinopathy’:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/search_codes_by_description.html">search_codes_by_description</a></span><span class="op">(</span>reg_expr <span class="op">=</span> <span class="st">"diabetic retinopathy"</span>, 
                          code_type <span class="op">=</span> <span class="st">"read2"</span>, 
                          ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
                          ignore_case <span class="op">=</span> <span class="cn">TRUE</span>, 
                          codes_only <span class="op">=</span> <span class="cn">FALSE</span>,
                          preferred_description_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 3</span>
<span class="co">#&gt;   read_code term_code term_description                                          </span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                                                     </span>
<span class="co">#&gt; 1 2BBJ.     00        O/E - no right diabetic retinopathy                       </span>
<span class="co">#&gt; 2 2BBk.     00        O/E - right eye stable treated proliferative diabetic ret…</span>
<span class="co">#&gt; 3 2BBK.     00        O/E - no left diabetic retinopathy                        </span>
<span class="co">#&gt; 4 2BBl.     00        O/E - left eye stable treated proliferative diabetic reti…</span>
<span class="co">#&gt; 5 2BBo.     00        O/E - sight threatening diabetic retinopathy              </span>
<span class="co">#&gt; 6 2BBP.     00        O/E - right eye background diabetic retinopathy</span></code></pre></div>
</div>
<div id="code-mapping" class="section level1">
<h1 class="hasAnchor">
<a href="#code-mapping" class="anchor"></a>Code mapping</h1>
<p>An example: map codes for type 1 diabetes from Read2 to Read3.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Some Read2 codes for T1DM</span>
<span class="va">t1dm_read2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C10E."</span>, <span class="st">"C108."</span><span class="op">)</span>

<span class="co"># lookup details</span>
<span class="fu"><a href="../reference/map_codes.html">map_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>, 
          from <span class="op">=</span> <span class="st">"read2"</span>, 
          to <span class="op">=</span> <span class="st">"read3"</span>, 
          ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
          codes_only <span class="op">=</span> <span class="cn">FALSE</span>,
          preferred_description_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 11</span>
<span class="co">#&gt;    CHAPTER READV2_CODE READV2_DESC TERMV2_DESC TERMV2_ORDER TERMV2_TYPE</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;      </span>
<span class="co">#&gt;  1 C       C108.       Insulin de… Insulin de… 00           P          </span>
<span class="co">#&gt;  2 C       C108.       Insulin de… Insulin de… 00           P          </span>
<span class="co">#&gt;  3 C       C108.       Insulin de… IDDM-Insul… 11           S          </span>
<span class="co">#&gt;  4 C       C108.       Insulin de… IDDM-Insul… 11           S          </span>
<span class="co">#&gt;  5 C       C108.       Insulin de… Type 1 dia… 12           S          </span>
<span class="co">#&gt;  6 C       C108.       Insulin de… Type I dia… 13           S          </span>
<span class="co">#&gt;  7 C       C10E.       Type 1 dia… Type 1 dia… 00           P          </span>
<span class="co">#&gt;  8 C       C10E.       Type 1 dia… Insulin de… 12           S          </span>
<span class="co">#&gt;  9 C       C10E.       Type 1 dia… Insulin de… 12           S          </span>
<span class="co">#&gt; 10 C       C10E.       Type 1 dia… Type I dia… 11           S          </span>
<span class="co">#&gt; # … with 5 more variables: READV3_CODE &lt;chr&gt;, TERMV3_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   TERMV3_TYPE &lt;chr&gt;, TERMV3_DESC &lt;chr&gt;, IS_ASSURED &lt;chr&gt;</span></code></pre></div>
<p>Note that by setting <code>preferred_description_only</code> to <code>TRUE</code>, some of the code values being mapped may not appear in the result if multiple codes map to a single code. In this example, both of the read2 codes <code>C10E.</code> and <code>C108.</code> map to a single read3 code, <code>X40J4</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Some Read2 codes for T1DM</span>
<span class="va">t1dm_read2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C10E."</span>, <span class="st">"C108."</span><span class="op">)</span>

<span class="co"># lookup details</span>
<span class="fu"><a href="../reference/map_codes.html">map_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>, 
          from <span class="op">=</span> <span class="st">"read2"</span>, 
          to <span class="op">=</span> <span class="st">"read3"</span>, 
          ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
          codes_only <span class="op">=</span> <span class="cn">FALSE</span>,
          preferred_description_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 11</span>
<span class="co">#&gt;   CHAPTER READV2_CODE READV2_DESC TERMV2_DESC TERMV2_ORDER TERMV2_TYPE</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;      </span>
<span class="co">#&gt; 1 C       C108.       Insulin de… Insulin de… 00           P          </span>
<span class="co">#&gt; # … with 5 more variables: READV3_CODE &lt;chr&gt;, TERMV3_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   TERMV3_TYPE &lt;chr&gt;, TERMV3_DESC &lt;chr&gt;, IS_ASSURED &lt;chr&gt;</span></code></pre></div>
<p>Mapping to ICD is more problematic as some results are a range of ICD codes (note also that for ICD-10, the mapping sheets use an alternative code format which removes any “.” characters):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/map_codes.html">map_codes</a></span><span class="op">(</span>codes <span class="op">=</span> <span class="va">t1dm_read2</span>, 
          from <span class="op">=</span> <span class="st">"read2"</span>, 
          to <span class="op">=</span> <span class="st">"icd10"</span>, 
          ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>, 
          codes_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "E100-E109"</span></code></pre></div>
<p>The available mappings do not cover all possible mapping directions. For example, while there are mappings for Read2 to ICD-10, there is no mapping for ICD-10 to Read2. For cases like this, <code><a href="../reference/map_codes.html">map_codes()</a></code> will attempt to map anyway:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># find ICD-10 code matching "diabetic retinopathy"</span>
<span class="fu"><a href="../reference/search_codes_by_description.html">search_codes_by_description</a></span><span class="op">(</span>
  reg_expr <span class="op">=</span> <span class="st">"diabetic retinopathy"</span>,
  code_type <span class="op">=</span> <span class="st">"icd10"</span>,
  ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>,
  ignore_case <span class="op">=</span> <span class="cn">TRUE</span>,
  codes_only <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 12</span>
<span class="co">#&gt;   ICD10_CODE ALT_CODE USAGE USAGE_UK DESCRIPTION MODIFIER_4 MODIFIER_5</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;     </span>
<span class="co">#&gt; 1 H36.0      H360     ASTE… 2        Diabetic r… &lt;NA&gt;       &lt;NA&gt;      </span>
<span class="co">#&gt; # … with 5 more variables: QUALIFIERS &lt;chr&gt;, GENDER_MASK &lt;chr&gt;, MIN_AGE &lt;chr&gt;,</span>
<span class="co">#&gt; #   MAX_AGE &lt;chr&gt;, TREE_DESCRIPTION &lt;chr&gt;</span></code></pre></div>
<p>However, this returns a <code>NULL</code> result when attempting to map the following:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># try mapping this ICD-10 code for diabetic retinopathy to Read codes</span>
<span class="va">icd10_diabetic_retinopathy</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/search_codes_by_description.html">search_codes_by_description</a></span><span class="op">(</span>
    reg_expr <span class="op">=</span> <span class="st">"diabetic retinopathy"</span>,
    code_type <span class="op">=</span> <span class="st">"icd10"</span>,
    ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>,
    ignore_case <span class="op">=</span> <span class="cn">TRUE</span>,
    codes_only <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>

<span class="co"># this returns a `NULL` result however</span>
<span class="va">icd10_diabetic_retinopathy_as_read_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_codes.html">map_codes</a></span><span class="op">(</span>
  codes <span class="op">=</span> <span class="va">icd10_diabetic_retinopathy</span>,
  from <span class="op">=</span> <span class="st">"icd10"</span>,
  to <span class="op">=</span> <span class="st">"read2"</span>,
  ukb_code_mappings <span class="op">=</span> <span class="va">ukb_code_mappings</span>,
  codes_only <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; Warning in map_codes(codes = icd10_diabetic_retinopathy, from = "icd10", :</span>
<span class="co">#&gt; Warning! No mapping sheet available for this request. Attempting to map anyway</span>
<span class="co">#&gt; using: read_v2_icd10</span>
<span class="co">#&gt; Warning in warning_if_codes_not_found(codes = codes, code_type = from,</span>
<span class="co">#&gt; search_col = ukb_code_mappings[[mapping_sheet]][[from_col]]): Warning! The</span>
<span class="co">#&gt; following codes were not found for icd10 (the coding system being mapped from):</span>
<span class="co">#&gt; 'H360'</span></code></pre></div>
<p>Inspecting the mapping sheet <code>read_v2_icd10</code> shows why:</p>
<blockquote>
<p><strong>Note:</strong> “H36.0” is converted to “H360” by <code>map_codes</code> internally, as this is the format used by the mapping sheets.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ukb_code_mappings</span><span class="op">$</span><span class="va">read_v2_icd10</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">icd10_code</span>, pattern <span class="op">=</span> <span class="st">"H360"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 17 x 3</span>
<span class="co">#&gt;    read_code icd10_code  icd10_code_def</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;         </span>
<span class="co">#&gt;  1 C1087     E103D H360A 7             </span>
<span class="co">#&gt;  2 C1096     E113D H360A 7             </span>
<span class="co">#&gt;  3 C10E7     E103D H360A 7             </span>
<span class="co">#&gt;  4 C10EP     E103D H360A 7             </span>
<span class="co">#&gt;  5 C10F6     E113D H360A 7             </span>
<span class="co">#&gt;  6 C10FQ     E113D H360A 7             </span>
<span class="co">#&gt;  7 F420.     E143D H360A 7             </span>
<span class="co">#&gt;  8 F4200     E143D H360A 7             </span>
<span class="co">#&gt;  9 F4201     E143D H360A 7             </span>
<span class="co">#&gt; 10 F4202     E143D H360A 7             </span>
<span class="co">#&gt; 11 F4203     E143D H360A 7             </span>
<span class="co">#&gt; 12 F4204     E143D H360A 7             </span>
<span class="co">#&gt; 13 F4205     H360A       5             </span>
<span class="co">#&gt; 14 F4206     E143D H360A 7             </span>
<span class="co">#&gt; 15 F4207     E143D H360A 7             </span>
<span class="co">#&gt; 16 F4208     E143D H360A 7             </span>
<span class="co">#&gt; 17 F420z     E143D H360A 7</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alasdair Warwick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

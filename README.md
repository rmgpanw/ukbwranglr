
<!-- README.md is generated from README.Rmd. Please edit that file -->

# ukbwranglr <img src="man/figures/test.png" align="right" width="100" />

<!-- badges: start -->

<!-- badges: end -->

# Overview

The goal of `ukbwranglr` is to facilitate exploratory analyses with UK
Biobank phenotype data. A raw UK Biobank phenotype file (or a subset of
selected columns) can be loaded into R with human-readable labels:

*Raw data appearance:*

    #>      eid 31-0.0 34-0.0 21000-0.0 20002-0.0 21001-0.0
    #> 1: fake1      0   1946      2002      1139   26.1735
    #> 2: fake2      0   1946         3      1287   13.8933
    #> 3: fake3      0   1946      4003      1663   25.8040
    #> 4: fake4      1     NA      3003      1086   29.4059
    #> 5: fake5      0   1956      3001        NA   24.8359

*Appearance when loaded using `ukbwranglr::read_pheno()`:*

    #>      eid sex_f31_0_0 year_of_birth_f34_0_0 ethnic_background_f21000_0_0
    #> 1: fake1      Female                  1946      White and Black African
    #> 2: fake2      Female                  1946       Asian or Asian British
    #> 3: fake3      Female                  1946   Any other Black background
    #> 4: fake4        Male                    NA                  Bangladeshi
    #> 5: fake5      Female                  1956                       Indian
    #>    noncancer_illness_code_selfreported_f20002_0_0
    #> 1:               oesophagitis/barretts oesophagus
    #> 2:                          anxiety/panic attacks
    #> 3:                        abnormal smear (cervix)
    #> 4:                       subarachnoid haemorrhage
    #> 5:                                           <NA>
    #>    body_mass_index_bmi_f21001_0_0
    #> 1:                        26.1735
    #> 2:                        13.8933
    #> 3:                        25.8040
    #> 4:                        29.4059
    #> 5:                        24.8359

Also included are functions to help with pre-processing the data into an
analysable format. For example:

  - Identify participants with certain health conditions or taking
    certain medications (with dates)
  - Summarise repeated biomarker measurements (e.g. extract the mean
    systolic blood pressure measurement)

Please see [‘getting
started’](https://rmgpanw.github.io/ukbwranglr/articles/ukbwranglr.html)
on the [package documentation
website](https://rmgpanw.github.io/ukbwranglr/index.html) for further
details.

## Installation

You can install the development version of ukbwranglr from
[GitHub](https://github.com/rmgpanw/ukbwranglr/tree/dtable) with:

``` r
# install.packages("devtools")
devtools::install_github("rmgpanw/ukbwranglr")
```

## Basic usage - reading a UK Biobank dataset into R

Steps:

1.  Create a data dictionary specific to your UK Biobank file - this is
    generated by downloading the full UK Biobank data dictionary,
    available on their
    [website](https://biobank.ctsu.ox.ac.uk/crystal/exinfo.cgi?src=accessing_data_guide)
2.  Filter this for the variables you require (optional)
3.  Read your selected columns into R

This process is outlined below for dummy data generated using the [tofu
library](https://github.com/spiros/tofu). Details of how to do this
using dummy UK Biobank data (included with this package) are
[here](TODO).

### Create data dictionary

``` r
# load package
library(ukbwranglr)

# create data dictionary
data_dict <- pheno_data_dict("MY_UKB_FILE.tab")
```

### Filter data dictionary for required variables (optional)

> *Note: you could also write the data dictionary to a `.csv` file and
> filter for your required fields manually in excel*

``` r
# Filter for sex, year of birth, BMI and self-reported noncancer-illness fields
data_dict <- data_dict %>%
  dplyr::filter(FieldID %in% c(31,
                               34,
                               21001,
                               20002))
```

### Read selected columns into R

``` r
ukb_pheno <- read_pheno(path = "MY_UKB_FILE.tab", 
                        ukb_data_dict = data_dict)
```
